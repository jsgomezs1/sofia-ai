# Supabase Integration Setup Guide

## Overview
This guide will help you set up Supabase integration for the Sofia.AI interview platform.

## Prerequisites
- A Supabase account (sign up at https://supabase.com)
- Node.js and npm/pnpm installed

## Step 1: Create Supabase Project

1. Go to https://supabase.com and sign in
2. Click "New Project"
3. Fill in your project details:
   - Project name: `sofia-ai` (or your preferred name)
   - Database password: (choose a strong password)
   - Region: (select closest to your users)
4. Click "Create new project" and wait for setup to complete

## Step 2: Create Database Table

1. In your Supabase dashboard, go to the SQL Editor
2. Run the following SQL to create the `tech` table:

```sql
create table public.tech (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  name text null,
  constraint tech_pkey primary key (id)
) TABLESPACE pg_default;
```

3. (Optional) Insert some sample data:

```sql
INSERT INTO public.tech (name) VALUES
  ('React'),
  ('Vue.js'),
  ('Angular'),
  ('Svelte'),
  ('Next.js'),
  ('Node.js'),
  ('Python'),
  ('Java'),
  ('Go'),
  ('Ruby'),
  ('MERN Stack'),
  ('MEAN Stack'),
  ('Django'),
  ('Spring Boot'),
  ('Ruby on Rails');
```

## Step 3: Get API Credentials

1. In your Supabase dashboard, go to Settings → API
2. Copy the following values:
   - **Project URL** (under "Project URL")
   - **anon/public key** (under "Project API keys")

## Step 4: Configure Environment Variables

1. Create a `.env.local` file in the root of your project (if it doesn't exist)
2. Add your Supabase credentials:

```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

**Important:** Replace the placeholder values with your actual Supabase credentials.

## Step 5: Install Dependencies

The Supabase client library has already been installed. If you need to reinstall:

```bash
npm install @supabase/supabase-js
```

## Step 6: Test the Integration

1. Start your development server:

```bash
npm run dev
```

2. Open your browser and navigate to `http://localhost:3000`
3. The Tech Stack dropdown should now load options from your Supabase database

## Files Created/Modified

### New Files:
- `lib/supabase.ts` - Supabase client configuration with TypeScript types
- `.env.local` - Environment variables (add your credentials here)

### Modified Files:
- `lib/TechStackSelection.tsx` - Updated to fetch data from Supabase
- `package.json` - Added `@supabase/supabase-js` dependency

## Features Implemented

### ✅ Supabase Client Setup
- Typed client instance with Database interface
- Environment variable validation
- Reusable across the application

### ✅ Dynamic Tech Stack Loading
- Fetches tech options from database on component mount
- Loading state with spinner
- Error handling with user-friendly messages
- Alphabetically sorted options

### ✅ Real-time Updates (Optional Enhancement)
- Subscribes to database changes
- Automatically refetches data when tech stacks are added/updated/deleted
- Cleans up subscription on component unmount

## Troubleshooting

### Error: "Missing Supabase environment variables"
- Make sure `.env.local` exists and contains valid credentials
- Restart your development server after adding environment variables

### Error: "Failed to load tech stacks"
- Check that the `tech` table exists in your Supabase database
- Verify your API credentials are correct
- Check browser console for detailed error messages

### No options showing in dropdown
- Make sure you have data in the `tech` table
- Run the sample INSERT query from Step 2

### Real-time updates not working
- Ensure real-time is enabled in Supabase (Settings → Database → Replication)
- Check that your table has Row Level Security policies if enabled

## Security Notes

- The `NEXT_PUBLIC_` prefix makes these variables available in the browser
- The anon/public key is safe to expose as it only allows operations permitted by Row Level Security (RLS)
- For production, consider implementing RLS policies on the `tech` table
- Never commit `.env.local` to version control (it's in `.gitignore`)

## Next Steps

Consider implementing:
1. **Row Level Security (RLS)** policies for the tech table
2. **Admin interface** to manage tech stacks
3. **Caching** to reduce database queries
4. **Search/filter** functionality for large tech lists
5. **Categories** to group technologies (Frontend, Backend, Full Stack)

## Support

For issues with:
- Supabase: https://supabase.com/docs
- This integration: Check the component code in `lib/TechStackSelection.tsx`

